[{"text":"{\n    \"tiddlers\": {\n        \"$:/plugins/DoolPlex/GroupedTable/GroupedTable.js\": {\n            \"created\": \"20220107151427710\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/DoolPlex/GroupedTable/GroupedTable.js\\ntype: application/javascript\\nmodule-type: macro\\nA TiddlyWiki 5 macro which creates a table with rowgrouping\\n\\\\*/\\n(function() {\\n\\n    /*jslint node: true, browser: true */\\n    /*global $tw: false */\\n    \\\"use strict\\\";\\n\\n    exports.name = \\\"groupedtable\\\";\\n\\n    exports.params = [\\n        {name: \\\"tag\\\", default: \\\"\\\"},\\n        {name: \\\"groupfield\\\", default: \\\"\\\"},\\n        {name: \\\"fieldlist\\\",  default: \\\"\\\"},\\n        {name: \\\"filtercriteria\\\",  default: \\\"\\\"}\\n    ];\\n\\n    /*\\n    Run the macro. Make sure it accepts the parameters you have defined above.\\n    */\\n    exports.run = function(tag, groupfield, fieldlist, filtercriteria) {\\n        try {\\n            var fields = fieldlist.split(\\\",\\\");\\n            var nrofFields = fields.length;\\n            var filter = \\\"[tag[\\\" + tag + \\\"]\\\" + filtercriteria + \\\"each[\\\" + groupfield + \\\"]sort[\\\" + groupfield + \\\"]]\\\";\\n            var subfilter = \\\"[tag[\\\" + tag + \\\"]\\\" + filtercriteria + \\\"field:\\\" + groupfield + \\\"{!!\\\" + groupfield + \\\"}sort[title]]\\\";\\n\\n            var resultText = \\\"\\\";\\n\\n            // Write the header of the table\\n            resultText += \\\"<table><tr class='gt-headerrow'>\\\";\\n\\n            for (var i = 0; i < nrofFields; i++)\\n            {\\n                if (fields[i][0] == \\\"*\\\" )\\n                    resultText += \\\"<th align=left>\\\" + fields[i].slice(-(fields[i].length-1))  + \\\"</th>\\\"; \\n                else\\n                    resultText += \\\"<th align=left>\\\" + fields[i] + \\\"</th>\\\"; \\n            }\\n\\n            resultText += \\\"</tr>\\\"; \\n            console.log(\\\"Header written\\\");\\n\\n\\n            if (groupfield == \\\"\\\") {\\n                filter = \\\"[tag[\\\" + tag + \\\"]sort[\\\" + groupfield + \\\"]\\\" + filtercriteria + \\\"]\\\";\\n\\n                resultText += \\\"<$list filter=\\\" + filter + \\\">\\\";\\n                resultText += \\\"<tr>\\\";\\n\\n                for (var fi = 0; fi < nrofFields; fi++) {\\n                    if (fi == 0) \\n                        resultText += \\\"<td><$link to[[!!title]]><$view field=\\\" + fields[fi] + \\\" /></$link></td>\\\";\\n                    else if (fields[fi][0] == \\\"*\\\" )\\n                        resultText += \\\"<td><$link to={{!!\\\" + fields[fi].slice(-(fields[fi].length-1)) + \\\"}}><$view field=\\\" + fields[fi].slice(-(fields[fi].length-1)) + \\\" /></$link></td>\\\";\\n                    else\\n                        resultText += \\\"<td><$view field=\\\" + fields[fi] + \\\" /></td>\\\";\\n                }\\n\\n                resultText += \\\"</tr>\\\";\\n                resultText += \\\"</$list>\\\";\\n            } else {\\n                resultText += \\\"<$list filter=\\\" + filter + \\\">\\\";\\n                resultText += \\\"<tr><td class='gt-groupheader' colspan='\\\" + nrofFields + \\\"'>\\\" + groupfield + \\\":&nbsp;<$view field='\\\" + groupfield + \\\"' /></td></tr>\\\";\\n                resultText += \\\"<$list filter='\\\" + subfilter + \\\"'>\\\";\\n                resultText += \\\"<tr>\\\";\\n\\n                for (var fi = 0; fi < nrofFields; fi++) {\\n                    if (fi == 0) \\n                        resultText += \\\"<td><$link to[[!!title]]><$view field=\\\" + fields[fi] + \\\" /></$link></td>\\\";\\n                    else if (fields[fi][0] == \\\"*\\\" )\\n                        resultText += \\\"<td><$link to={{!!\\\" + fields[fi].slice(-(fields[fi].length-1)) + \\\"}}><$view field=\\\" + fields[fi].slice(-(fields[fi].length-1)) + \\\" /></$link></td>\\\";\\n                    else\\n                        resultText += \\\"<td><$view field=\\\" + fields[fi] + \\\" /></td>\\\";\\n                }\\n\\n                resultText += \\\"</tr>\\\";\\n                resultText += \\\"</$list>\\\";\\n                resultText += \\\"</$list>\\\";\\n            }\\n\\n            // close the table and return the result\\n            resultText += \\\"</table>\\\"; \\n\\n            return resultText;\\n        } catch (err) {\\n            console.error(err.stack)\\n            return \\\"(ERROR: \\\" + err.message + \\\") \\\";\\n        }\\n    };\\n\\n})();\",\n            \"tags\": \"\",\n            \"title\": \"$:/plugins/DoolPlex/GroupedTable/GroupedTable.js\",\n            \"modified\": \"20220107160721589\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"macro\"\n        },\n        \"$:/plugins/DoolPlex/GroupedTable/GTStyles\": {\n            \"created\": \"20220107155134653\",\n            \"text\": \"table {\\n    border-spacing: 0;\\n    width: 100%;\\n    border: 1px solid #ddd;\\n}\\n\\n.gt-groupheader {\\n    background-color: #525252;\\n    font-weight: bold;\\n}\\n\\n\\nth.asc2::after { \\n    content: \\\" ▲\\\";\\n}\\n\\nth.desc2::after { \\n    content: \\\" ▼\\\";\\n}\\n\",\n            \"tags\": \"$:/tags/Stylesheet\",\n            \"title\": \"$:/plugins/DoolPlex/GroupedTable/GTStyles\",\n            \"modified\": \"20220107160651542\",\n            \"type\": \"text/css\"\n        }\n    }\n}","version":"0.2.1","type":"application/json","title":"$:/plugins/DoolPlex/GroupedTable","tags":"","plugin-type":"plugin","name":"GroupedTable","modifier":"Joost van den Dool","modified":"20220107160405204","description":"Plugin for tables with row level grouping","dependents":" ","creator":"Joost van den Dool","created":"20220103191717357"}]