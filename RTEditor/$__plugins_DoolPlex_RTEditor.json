[{"created":"20220103192147211","creator":"Joost van den Dool","text":"{\n    \"tiddlers\": {\n        \"$:/plugins/DoolPlex/RTEditor/RTEditorWidget.js\": {\n            \"created\": \"20220104082736622\",\n            \"creator\": \"Joost van den Dool\",\n            \"text\": \"/*\\\\\\ntitle: $:/plugins/DoolPlex/RTEditor/RTEditorWidget.js\\ntype: application/javascript\\nmodule-type: widget\\n\\n  Rich Text Editor widget\\n\\n\\\\*/\\n\\n/*jslint node: true, browser: true */\\n/*global $tw: false */\\n\\n(function() {\\n    'use strict';\\n  \\n    var Widget = require(\\\"$:/core/modules/widgets/widget.js\\\").widget;\\n    \\n    var RTEditorWidget = function(parseTreeNode,options) {\\n        this.initialise(parseTreeNode,options);\\n      };\\n    \\n    RTEditorWidget.prototype = new Widget();\\n\\n    RTEditorWidget.prototype.render = function(parent,nextSibling) {\\n      this.parentDomNode = parent;\\n      this.editTitle = this.getAttribute(\\\"tiddler\\\",this.getVariable(\\\"currentTiddler\\\"));\\n\\t\\t\\tthis.editField = this.getAttribute(\\\"field\\\",\\\"text\\\");\\n\\n\\n      // Rendering toolbars\\n      var toolbar = this.document.createElement('div');\\n      toolbar.setAttribute('id', 'toolbar1');\\n      toolbar.innerHTML = this.Toolbar1();\\n      parent.insertBefore(toolbar, nextSibling);\\n      this.domNodes.push(toolbar);\\n\\n      toolbar = this.document.createElement('div');\\n      toolbar.setAttribute('id', 'toolbar2');\\n      toolbar.innerHTML = this.Toolbar2();\\n      parent.insertBefore(toolbar, nextSibling);\\n      this.domNodes.push(toolbar);\\n\\n\\n      // Rendering the text area\\n      var textarea = this.document.createElement('div');\\n      textarea.style.border = '1px #000000 solid;';\\n      textarea.style.width = '100%';\\n      textarea.style.height = '15em';\\n      textarea.style.overflow = 'scroll;';\\n      textarea.setAttribute('id', 'textarea');\\n      textarea.setAttribute('class', 'RTEBox');\\n      textarea.setAttribute('contenteditable', 'true');\\n\\n      // adding eventhandler for keys\\n      textarea.addEventListener('keydown', function(e) {\\n        if (e.shiftKey && e.key == 'Tab') {\\n          e.preventDefault();\\n\\n          \\n          document.execCommand('outdent', false);\\n          document.getElementById('textarea').focus();    \\n\\n        } else if (e.key == 'Tab') {\\n          e.preventDefault();\\n\\n          document.execCommand('indent', false);\\n          document.getElementById('textarea').focus();    \\n        }\\n      });\\n\\n      textarea.addEventListener('focusout', function(e) {\\n        var value = textarea.innerHTML;\\n\\n        var tiddler = self.wiki.getTiddler(self.editTitle),\\n\\t\\t\\t\\t\\t\\tupdateFields = {\\n\\t\\t\\t\\t\\t\\t\\ttitle: self.editTitle\\n\\t\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t\\tupdateFields[self.editField] = value;\\n\\t\\t\\t\\t\\tself.wiki.addTiddler(new $tw.Tiddler(self.wiki.getCreationFields(),tiddler,updateFields,self.wiki.getModificationFields()));\\n      });\\n\\n\\n      // Setting the value\\n      var tiddler = this.wiki.getTiddler(this.editTitle);\\n      textarea.innerHTML = tiddler.getFieldString(this.editField);\\n\\n      // Adding observer for handling changes and saving them\\n      var self = this;\\n      var observer = new MutationObserver(function(mutations) {\\n        var value = textarea.innerHTML;\\n\\n        var tiddler = self.wiki.getTiddler(self.editTitle),\\n\\t\\t\\t\\t\\t\\tupdateFields = {\\n\\t\\t\\t\\t\\t\\t\\ttitle: self.editTitle\\n\\t\\t\\t\\t\\t\\t};\\n\\t\\t\\t\\t\\tupdateFields[self.editField] = value;\\n\\t\\t\\t\\t\\tself.wiki.addTiddler(new $tw.Tiddler(self.wiki.getCreationFields(),tiddler,updateFields,self.wiki.getModificationFields()));\\n      });\\n\\n      var config = { characterData: true, attributes: false, childList: true, subtree: true };\\n//      observer.observe(textarea, config);\\n\\n    \\n      // Adding textarea to DOM\\n      parent.insertBefore(textarea, nextSibling);\\n      this.domNodes.push(textarea);\\n\\n      textarea.focus();\\n    };\\n\\n\\n    RTEditorWidget.prototype.refresh = function(changedTiddlers) {\\n      this.refreshSelf();\\n      return true;\\n    };\\n\\n    RTEditorWidget.prototype.Toolbar1 = function() {\\n        return `\\n            <select onchange=\\\"document.execCommand('formatblock', false, this[this.selectedIndex].value); document.getElementById('textarea').focus();this.selectedIndex=0;\\\">\\n                <option selected>- formatting -</option>\\n                <option value=\\\"h1\\\">Title 1 &lt;h1&gt;</option>\\n                <option value=\\\"h2\\\">Title 2 &lt;h2&gt;</option>\\n                <option value=\\\"h3\\\">Title 3 &lt;h3&gt;</option>\\n                <option value=\\\"h4\\\">Title 4 &lt;h4&gt;</option>\\n                <option value=\\\"h5\\\">Title 5 &lt;h5&gt;</option>\\n                <option value=\\\"h6\\\">Subtitle &lt;h6&gt;</option>\\n                <option value=\\\"p\\\">Paragraph &lt;p&gt;</option>\\n                <option value=\\\"pre\\\">Preformatted &lt;pre&gt;</option>\\n            </select>\\n            <select onchange=\\\"document.execCommand('forecolor', false, this[this.selectedIndex].value); document.getElementById('textarea').focus();this.selectedIndex=0;\\\">\\n                <option class=\\\"heading\\\" selected>- color -</option>\\n                <option value=\\\"red\\\">Red</option>\\n                <option value=\\\"blue\\\">Blue</option>\\n                <option value=\\\"green\\\">Green</option>\\n                <option value=\\\"black\\\">Black</option>\\n            </select>\\n            <select onchange=\\\"document.execCommand('backcolor', false, this[this.selectedIndex].value); document.getElementById('textarea').focus();this.selectedIndex=0;\\\">\\n                <option class=\\\"heading\\\" selected>- background -</option>\\n                <option value=\\\"red\\\">Red</option>\\n                <option value=\\\"green\\\">Green</option>\\n                <option value=\\\"black\\\">Black</option>\\n            </select>\\n        `;\\n    }\\n\\n    RTEditorWidget.prototype.Toolbar2 = function() {\\n        return `\\n            <img class=\\\"intLink\\\" title=\\\"Undo\\\" onclick=\\\"document.execCommand('undo', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAOMKADljwliE33mOrpGjuYKl8aezxqPD+7/I19DV3NHa7P///////////////////////yH5BAEKAA8ALAAAAAAWABYAAARR8MlJq7046807TkaYeJJBnES4EeUJvIGapWYAC0CsocQ7SDlWJkAkCA6ToMYWIARGQF3mRQVIEjkkSVLIbSfEwhdRIH4fh/DZMICe3/C4nBQBADs=\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Redo\\\" onclick=\\\"document.execCommand('redo', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAMIHAB1ChDljwl9vj1iE34Kl8aPD+7/I1////yH5BAEKAAcALAAAAAAWABYAAANKeLrc/jDKSesyphi7SiEgsVXZEATDICqBVJjpqWZt9NaEDNbQK1wCQsxlYnxMAImhyDoFAElJasRRvAZVRqqQXUy7Cgx4TC6bswkAOw==\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Remove formatting\\\" onclick=\\\"document.execCommand('removeFormat', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAABGdBTUEAALGPC/xhBQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB9oECQMCKPI8CIIAAAAIdEVYdENvbW1lbnQA9syWvwAAAuhJREFUOMtjYBgFxAB501ZWBvVaL2nHnlmk6mXCJbF69zU+Hz/9fB5O1lx+bg45qhl8/fYr5it3XrP/YWTUvvvk3VeqGXz70TvbJy8+Wv39+2/Hz19/mGwjZzuTYjALuoBv9jImaXHeyD3H7kU8fPj2ICML8z92dlbtMzdeiG3fco7J08foH1kurkm3E9iw54YvKwuTuom+LPt/BgbWf3//sf37/1/c02cCG1lB8f//f95DZx74MTMzshhoSm6szrQ/a6Ir/Z2RkfEjBxuLYFpDiDi6Af///2ckaHBp7+7wmavP5n76+P2ClrLIYl8H9W36auJCbCxM4szMTJac7Kza////R3H1w2cfWAgafPbqs5g7D95++/P1B4+ECK8tAwMDw/1H7159+/7r7ZcvPz4fOHbzEwMDwx8GBgaGnNatfHZx8zqrJ+4VJBh5CQEGOySEua/v3n7hXmqI8WUGBgYGL3vVG7fuPK3i5GD9/fja7ZsMDAzMG/Ze52mZeSj4yu1XEq/ff7W5dvfVAS1lsXc4Db7z8C3r8p7Qjf///2dnZGxlqJuyr3rPqQd/Hhyu7oSpYWScylDQsd3kzvnH738wMDzj5GBN1VIWW4c3KDon7VOvm7S3paB9u5qsU5/x5KUnlY+eexQbkLNsErK61+++VnAJcfkyMTIwffj0QwZbJDKjcETs1Y8evyd48toz8y/ffzv//vPP4veffxpX77z6l5JewHPu8MqTDAwMDLzyrjb/mZm0JcT5Lj+89+Ybm6zz95oMh7s4XbygN3Sluq4Mj5K8iKMgP4f0////fv77//8nLy+7MCcXmyYDAwODS9jM9tcvPypd35pne3ljdjvj26+H2dhYpuENikgfvQeXNmSl3tqepxXsqhXPyc666s+fv1fMdKR3TK72zpix8nTc7bdfhfkEeVbC9KhbK/9iYWHiErbu6MWbY/7//8/4//9/pgOnH6jGVazvFDRtq2VgiBIZrUTIBgCk+ivHvuEKwAAAAABJRU5ErkJggg==\\\">\\n            <img class=\\\"intLink\\\" title=\\\"Bold\\\" onclick=\\\"document.execCommand('bold', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAInhI+pa+H9mJy0LhdgtrxzDG5WGFVk6aXqyk6Y9kXvKKNuLbb6zgMFADs=\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Italic\\\" onclick=\\\"document.execCommand('italic', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAKEDAAAAAF9vj5WIbf///yH5BAEAAAMALAAAAAAWABYAAAIjnI+py+0Po5x0gXvruEKHrF2BB1YiCWgbMFIYpsbyTNd2UwAAOw==\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Underline\\\" onclick=\\\"document.execCommand('underline', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAKECAAAAAF9vj////////yH5BAEAAAIALAAAAAAWABYAAAIrlI+py+0Po5zUgAsEzvEeL4Ea15EiJJ5PSqJmuwKBEKgxVuXWtun+DwxCCgA7\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Left align\\\" onclick=\\\"document.execCommand('justifyleft', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIghI+py+0Po5y02ouz3jL4D4JMGELkGYxo+qzl4nKyXAAAOw==\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Center align\\\" onclick=\\\"document.execCommand('justifycenter', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIfhI+py+0Po5y02ouz3jL4D4JOGI7kaZ5Bqn4sycVbAQA7\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Right align\\\" onclick=\\\"document.execCommand('justifyright', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAID/AMDAwAAAACH5BAEAAAAALAAAAAAWABYAQAIghI+py+0Po5y02ouz3jL4D4JQGDLkGYxouqzl43JyVgAAOw==\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Numbered list\\\" onclick=\\\"document.execCommand('insertorderedlist', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAMIGAAAAADljwliE35GjuaezxtHa7P///////yH5BAEAAAcALAAAAAAWABYAAAM2eLrc/jDKSespwjoRFvggCBUBoTFBeq6QIAysQnRHaEOzyaZ07Lu9lUBnC0UGQU1K52s6n5oEADs=\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Dotted list\\\" onclick=\\\"document.execCommand('insertunorderedlist', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAMIGAAAAAB1ChF9vj1iE33mOrqezxv///////yH5BAEAAAcALAAAAAAWABYAAAMyeLrc/jDKSesppNhGRlBAKIZRERBbqm6YtnbfMY7lud64UwiuKnigGQliQuWOyKQykgAAOw==\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Quote\\\" onclick=\\\"document.execCommand('formatblock', false, 'blockquote'); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAIQXAC1NqjFRjkBgmT9nqUJnsk9xrFJ7u2R9qmKBt1iGzHmOrm6Sz4OXw3Odz4Cl2ZSnw6KxyqO306K63bG70bTB0rDI3bvI4P///////////////////////////////////yH5BAEKAB8ALAAAAAAWABYAAAVP4CeOZGmeaKqubEs2CekkErvEI1zZuOgYFlakECEZFi0GgTGKEBATFmJAVXweVOoKEQgABB9IQDCmrLpjETrQQlhHjINrTq/b7/i8fp8PAQA7\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Delete indentation\\\" onclick=\\\"document.execCommand('outdent', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAMIHAAAAADljwliE35GjuaezxtDV3NHa7P///yH5BAEAAAcALAAAAAAWABYAAAM2eLrc/jDKCQG9F2i7u8agQgyK1z2EIBil+TWqEMxhMczsYVJ3e4ahk+sFnAgtxSQDqWw6n5cEADs=\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Add indentation\\\" onclick=\\\"document.execCommand('indent', false); document.getElementById('textarea').focus();\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAOMIAAAAADljwl9vj1iE35GjuaezxtDV3NHa7P///////////////////////////////yH5BAEAAAgALAAAAAAWABYAAAQ7EMlJq704650B/x8gemMpgugwHJNZXodKsO5oqUOgo5KhBwWESyMQsCRDHu9VOyk5TM9zSpFSr9gsJwIAOw==\\\" />\\n            <img class=\\\"intLink\\\" title=\\\"Hyperlink\\\" onclick=\\\"var sLnk=prompt('Write the URL here','http:\\\\/\\\\/');if(sLnk&&sLnk!=''&&sLnk!='http://'){document.execCommand('createlink', false, sLnk); document.getElementById('textarea').focus();}\\\" src=\\\"data:image/gif;base64,R0lGODlhFgAWAOMKAB1ChDRLY19vj3mOrpGjuaezxrCztb/I19Ha7Pv8/f///////////////////////yH5BAEKAA8ALAAAAAAWABYAAARY8MlJq7046827/2BYIQVhHg9pEgVGIklyDEUBy/RlE4FQF4dCj2AQXAiJQDCWQCAEBwIioEMQBgSAFhDAGghGi9XgHAhMNoSZgJkJei33UESv2+/4vD4TAQA7\\\" />\\n        `;\\n    }\\n\\n    RTEditorWidget.prototype.getAttribute = function () {\\n\\t\\t\\t//parameters are passed to parent so get them from there\\n\\t\\t\\treturn this.parentWidget.getAttribute.apply(this.parentWidget, arguments);\\n\\t\\t}\\n\\n    RTEditorWidget.prototype.refresh = function(changedTiddlers) {\\n      return false;\\n    }\\n\\n\\n    exports.rteditor = RTEditorWidget;\\n\\n})();  \\n\",\n            \"tags\": \"\",\n            \"title\": \"$:/plugins/DoolPlex/RTEditor/RTEditorWidget.js\",\n            \"modified\": \"20220104082908130\",\n            \"modifier\": \"Joost van den Dool\",\n            \"type\": \"application/javascript\",\n            \"module-type\": \"widget\"\n        },\n        \"$:/plugins/DoolPlex/RTEditor/RTStyles\": {\n            \"created\": \"20220104082934251\",\n            \"creator\": \"Joost van den Dool\",\n            \"text\": \"[data-tags*=\\\"Note\\\"] div.tc-tiddler-body {\\n    display:none;\\n}\\n\\n.intLink { cursor: pointer; }\\n\\nimg.intLink { border: 0; }\\n\\n#toolBar1 select { font-size:10px; }\\n\\ndiv.RTEBox {\\n  width: 100%;\\n  height: 15em;\\n  border: 1px #000000 solid;\\n  padding: 12px;\\n  overflow: scroll;\\n}\\n\\n#textBox #sourceText {\\n  padding: 0;\\n  margin: 0;\\n  min-width: 498px;\\n  min-height: 200px;\\n}\\n\\n\",\n            \"tags\": \"$:/tags/Stylesheet\",\n            \"title\": \"$:/plugins/DoolPlex/RTEditor/RTStyles\",\n            \"modified\": \"20220104084307706\",\n            \"modifier\": \"Joost van den Dool\",\n            \"type\": \"text/css\"\n        },\n        \"$:/plugins/DoolPlex/RTEditor/RTViewTemplate\": {\n            \"created\": \"20220104083031217\",\n            \"creator\": \"Joost van den Dool\",\n            \"text\": \"<$list filter=\\\"[all[current]tag[Note]]\\\">\\n   <$rteditor/>\\n</$list>\",\n            \"tags\": \"$:/tags/ViewTemplate\",\n            \"title\": \"$:/plugins/DoolPlex/RTEditor/RTViewTemplate\",\n            \"modified\": \"20220104083116895\",\n            \"modifier\": \"Joost van den Dool\"\n        }\n    }\n}","tags":"","title":"$:/plugins/DoolPlex/RTEditor","modified":"20220103192222267","modifier":"Joost van den Dool","dependents":"","description":"Rich Text Editor with (shift-)Tab support","name":"RTEditor","plugin-type":"plugin","type":"application/json","version":"0.1.1"}]